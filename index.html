<!DOCTYPE html>
<html lang="vi">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>B·ªô c√¥ng c·ª• c·ªßa D∆∞∆°ng</title>
<style>
:root {
  --sidebar-bg: #1e293b;
  --bg: #0f172a;
  --card: #1e293b;
  --muted: #cbd5e1;
  --accent: #38bdf8;
  --text: #f8fafc;
}
* { box-sizing: border-box; transition: background-color .2s, color .2s; }
body { margin: 0; font-family: Inter, Segoe UI, Arial; background: var(--bg); color: var(--text); }
.app { display: flex; min-height: 100vh; }
.sidebar {
  width: 260px; background: var(--sidebar-bg); color: white; padding: 24px;
  display: flex; flex-direction: column; gap: 18px;
}
.brand { font-weight: 700; font-size: 18px; display: flex; align-items: center; gap: 10px; }
.menu { display: flex; flex-direction: column; gap: 6px; margin-top: 6px; }
.menu button {
  background: transparent; border: none; color: rgba(255,255,255,0.95); text-align: left;
  padding: 10px 12px; border-radius: 8px; cursor: pointer; font-size: 15px;
  display: flex; gap: 10px; align-items: center;
}
.menu button:hover { background: rgba(255,255,255,0.08); }
.menu button.active { background: white; color: var(--sidebar-bg); font-weight: 600; }
.footer { margin-top: auto; font-size: 13px; color: rgba(255,255,255,0.9); }

.main { flex: 1; padding: 28px; }
.header { display: flex; align-items: center; justify-content: space-between; margin-bottom: 18px; }
.card { background: var(--card); padding: 18px; border-radius: 12px; box-shadow: 0 6px 22px rgba(2,6,23,0.06); }
.grid { display: grid; grid-template-columns: 1fr; gap: 18px; }
.tool-wrap { display: none; animation: fade .18s ease both; }
.tool-wrap.active { display: block; }
textarea, input {
  font-family: monospace; background: var(--card); color: var(--text);
  border: 1px solid #475569; border-radius: 8px; padding: 8px; resize: vertical; width: 100%;
}
textarea.output { cursor: pointer; }
button.small { padding: 8px 12px; border-radius: 8px; border: none; background: var(--accent); color: white; cursor: pointer; }
h3.label { margin: 10px 0 5px; color: var(--muted); font-weight: 600; font-size: 15px; }
@keyframes fade { from { opacity: 0; transform: translateY(6px); } to { opacity: 1; transform: none; } }
</style>
</head>
<body class="dark">
<div class="app">
  <aside class="sidebar card">
    <div class="brand">üß∞ B·ªô c√¥ng c·ª• c·ªßa D∆∞∆°ng</div>
    <div class="menu" id="menu">
      <button data-show="locCot" class="active">üî¢ L·ªçc c·ªôt mu·ªën gi·ªØ</button>
      <button data-show="hoandoicot">üîÑ Ho√°n ƒë·ªïi c·ªôt</button>
      <button data-show="locloaibo">üîç L·ªçc d·ªØ li·ªáu (gi·ªØ / lo·∫°i)</button>
      <button data-show="locbotrung">üö´ L·ªçc danh s√°ch kh√¥ng tr√πng</button>
      <button data-show="locidbm">üß≠ L·ªçc IDBM</button>
    </div>
    <div class="footer">Phi√™n b·∫£n 6.1 ‚Äî Ho√°n ƒë·ªïi v√† gi·ªØ 2 c·ªôt</div>
  </aside>

  <main class="main">
    <div class="header">
      <div>
        <h1>üß∞ B·ªô c√¥ng c·ª• c·ªßa D∆∞∆°ng</h1>
        <div style="color:var(--muted)">Ch·ªçn c√¥ng c·ª• t·ª´ menu b√™n tr√°i</div>
      </div>
      <div><button class="small" id="toggleTheme">‚òÄÔ∏è</button></div>
    </div>

    <div class="grid">

      <!-- L·ªçc c·ªôt -->
      <section id="locCot" class="tool-wrap active card">
        <h2>üî¢ L·ªçc c·ªôt mu·ªën gi·ªØ</h2>
        <textarea id="col_input" rows="6" placeholder="V√≠ d·ª•:&#10;A|B|C|D|E"></textarea>
        <input id="col_keep" placeholder="V√≠ d·ª•: 1,3" />
        <h3 class="label">K·∫øt qu·∫£:</h3>
        <textarea id="col_output" rows="6" readonly class="output"></textarea>
      </section>

      <!-- Ho√°n ƒë·ªïi c·ªôt -->
      <section id="hoandoicot" class="tool-wrap card">
        <h2>üîÑ Ho√°n ƒë·ªïi v√† gi·ªØ 2 c·ªôt</h2>
        <div style="margin-bottom:10px;">
          <label>C·ªôt 1:</label><input id="col1" type="number" value="2" style="width:60px;margin-right:12px;">
          <label>C·ªôt 2:</label><input id="col2" type="number" value="3" style="width:60px;margin-right:12px;">
          <button id="btnSwap" class="small">Ho√°n ƒë·ªïi</button>
        </div>
        <textarea id="swap_input" rows="8" placeholder="A|B|C|D|E"></textarea>
        <h3 class="label">K·∫øt qu·∫£:</h3>
        <textarea id="swap_output" rows="8" readonly class="output"></textarea>
      </section>

      <!-- L·ªçc gi·ªØ / lo·∫°i -->
      <section id="locloaibo" class="tool-wrap card">
        <h2>üîç L·ªçc d·ªØ li·ªáu (gi·ªØ / lo·∫°i)</h2>
        <textarea id="keep_input" rows="6" placeholder="A|B"></textarea>
        <textarea id="keep_list" rows="6" placeholder="Danh s√°ch c·∫ßn gi·ªØ..."></textarea>
        <h3 class="label">K·∫øt qu·∫£:</h3>
        <textarea id="keep_removed" rows="6" readonly class="output"></textarea>
      </section>

      <!-- L·ªçc kh√¥ng tr√πng -->
      <section id="locbotrung" class="tool-wrap card">
        <h2>üö´ L·ªçc danh s√°ch kh√¥ng tr√πng</h2>
        <textarea id="unique_a" rows="6" placeholder="1|A"></textarea>
        <textarea id="unique_b" rows="6" placeholder="1 2 3"></textarea>
        <h3 class="label">K·∫øt qu·∫£:</h3>
        <textarea id="unique_out" rows="6" readonly class="output"></textarea>
      </section>

      <!-- L·ªçc IDBM -->
      <section id="locidbm" class="tool-wrap card">
        <h2>üß≠ L·ªçc IDBM</h2>
        <textarea id="map_a" rows="6" placeholder="Danh s√°ch IDBM..."></textarea>
        <textarea id="map_b" rows="6" placeholder="Danh s√°ch IDTKQC..."></textarea>
        <textarea id="map_live" rows="6" placeholder="Danh s√°ch Live..."></textarea>
        <h3 class="label">K·∫øt qu·∫£:</h3>
        <textarea id="map_out" rows="6" readonly></textarea>
      </section>

    </div>
  </main>
</div>

<script>
// ===== MENU =====
const buttons=document.querySelectorAll(".menu button");
function showTool(id){
  document.querySelectorAll(".tool-wrap").forEach(s=>s.classList.remove("active"));
  document.getElementById(id).classList.add("active");
  buttons.forEach(b=>b.classList.toggle("active",b.dataset.show===id));
}
buttons.forEach(b=>b.addEventListener("click",()=>showTool(b.dataset.show)));

// ===== L·ªåC C·ªòT =====
function processColumns(){
  const input=document.getElementById("col_input").value.trim();
  const keepCols=document.getElementById("col_keep").value.trim().replace(/,/g," ").split(/\s+/).map(x=>parseInt(x)-1).filter(x=>!isNaN(x));
  const lines=input.split(/\r?\n/).map(l=>l.trim()).filter(l=>l);
  const result=lines.map(line=>{
    const cols=line.split("|");
    const kept=keepCols.map(i=>cols[i]||"").join("|");
    return kept;
  }).join("\n");
  document.getElementById("col_output").value=result||"(Kh√¥ng c√≥ d·ªØ li·ªáu)";
}
document.getElementById("col_input").addEventListener("input",processColumns);
document.getElementById("col_keep").addEventListener("input",processColumns);

// ===== HO√ÅN ƒê·ªîI & GI·ªÆ 2 C·ªòT =====
function swapAndKeepTwoColumns() {
  const inputText = document.getElementById("swap_input").value.trim();
  const c1 = parseInt(document.getElementById("col1").value, 10) - 1;
  const c2 = parseInt(document.getElementById("col2").value, 10) - 1;

  if (!inputText) {
    document.getElementById("swap_output").value = "(Kh√¥ng c√≥ d·ªØ li·ªáu)";
    return;
  }
  if (isNaN(c1) || isNaN(c2) || c1 < 0 || c2 < 0) {
    document.getElementById("swap_output").value = "(Vui l√≤ng nh·∫≠p v·ªã tr√≠ c·ªôt h·ª£p l·ªá)";
    return;
  }

  const lines = inputText.split(/\r?\n/);
  const result = lines.map(line => {
    if (!line.trim()) return "";
    const cols = line.split("|");
    while (cols.length <= Math.max(c1, c2)) cols.push("");
    const temp = cols[c1];
    cols[c1] = cols[c2];
    cols[c2] = temp;
    return [cols[c1], cols[c2]].join("|");
  }).join("\n");

  document.getElementById("swap_output").value = result || "(Kh√¥ng c√≥ d·ªØ li·ªáu)";
}
["col1","col2","swap_input"].forEach(id=>document.getElementById(id).addEventListener("input",swapAndKeepTwoColumns));
document.getElementById("btnSwap").addEventListener("click",swapAndKeepTwoColumns);

// ===== L·ªåC GI·ªÆ / LO·∫†I =====
["keep_input","keep_list"].forEach(id=>document.getElementById(id).addEventListener("input",()=>{
  const a=keep_input.value.split(/\n/).map(l=>l.split("|")[0].trim()).filter(Boolean);
  const b=keep_list.value.split(/\n/).map(l=>l.trim()).filter(Boolean);
  keep_removed.value=a.filter(x=>!b.includes(x)).join("\n")||"Kh√¥ng c√≥ m·ª•c b·ªã lo·∫°i";
}));

// ===== L·ªåC KH√îNG TR√ôNG =====
["unique_a","unique_b"].forEach(id=>document.getElementById(id).addEventListener("input",()=>{
  const a=unique_a.value.split(/\n/).map(l=>l.split("|")[0].trim()).filter(Boolean);
  const b=unique_b.value.split(/[\s\n]+/).filter(Boolean);
  unique_out.value=a.filter(x=>!b.includes(x)).join("\n")||"Kh√¥ng c√≥ d·ªØ li·ªáu.";
}));

// ===== MAP IDBM =====
["map_a","map_b","map_live"].forEach(id=>document.getElementById(id).addEventListener("input",()=>{
  const a=map_a.value.split(/\n/).map(l=>l.split("|")[0].trim()).filter(Boolean);
  const b=map_b.value.split(/\n/).map(l=>l.trim()).filter(Boolean);
  const live=map_live.value.split(/\n/).map(l=>l.trim()).filter(Boolean);
  const map={};b.forEach((v,i)=>map[v]=a[i]||"");
  map_out.value=live.map(v=>map[v]||"Kh√¥ng t√¨m th·∫•y").join("\n");
}));

// ===== DARK MODE =====
const toggle=document.getElementById("toggleTheme");
function applyTheme(dark){
  document.body.classList.toggle("dark",dark);
  toggle.textContent=dark?"‚òÄÔ∏è":"üåô";
  localStorage.setItem("theme",dark?"dark":"light");
}
toggle.addEventListener("click",()=>applyTheme(!document.body.classList.contains("dark")));
if(localStorage.getItem("theme")==="light")applyTheme(false); else applyTheme(true);
</script>
</body>
</html>
